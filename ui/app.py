paste the entire code from the document here